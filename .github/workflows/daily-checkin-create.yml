name: Daily Meal Check-in

on:
  schedule:
    - cron: '0 4 * * *'  # 8pm PST = 4:00 UTC next day
  workflow_dispatch:

permissions:
  issues: write

jobs:
  create-checkin:
    runs-on: ubuntu-latest
    steps:
      - name: Create daily check-in issue
        uses: actions/github-script@v7
        with:
          script: |
            // Get current date in PST timezone
            const today = new Date().toLocaleDateString('en-US', {
              timeZone: 'America/Los_Angeles',
              weekday: 'long',
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            });

            await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: `ğŸ“ Daily Check-in: ${today}`,
              body: `## ğŸ½ï¸ Dinner Check-in: ${today}

            ### Did you make the planned dinner?
            - [ ] âœ… Made as planned
            - [ ] â„ï¸ Made as planned + froze 2x batch
            - [ ] ğŸ² Used freezer backup
            - [ ] ğŸ”„ Made something else
            - [ ] ğŸ½ï¸ Ate out

            ---

            **If "Used freezer backup" â†’ which meal?**
            - [ ] Bisi Bele Bath
            - [ ] Dal Makhani
            - [ ] Pasta Sauce
            - [ ] Cheesy Veggie Quesadilla

            **If "Made something else" â†’ what did you make?**
            <!-- Enter meal name below -->

            ---

            ### What vegetables did you use tonight?
            _(Check all that apply)_

            - [ ] bell pepper
            - [ ] broccoli
            - [ ] carrot
            - [ ] corn
            - [ ] cucumber
            - [ ] garlic
            - [ ] onion
            - [ ] peas
            - [ ] potato
            - [ ] tomato
            - [ ] spinach
            - [ ] zucchini

            ---

            ### Kids' feedback?
            - [ ] â¤ï¸ Loved it
            - [ ] ğŸ‘ Liked it
            - [ ] ğŸ˜ Neutral
            - [ ] ğŸ‘ Didn't like
            - [ ] âŒ Refused to eat

            **Any complaints?** (optional)
            <!-- key:complaints -->

            ---

            ### Notes (optional)
            <!-- key:notes -->
            [Free text for any other observations]
            `,
              labels: ['daily-checkin']
            });

